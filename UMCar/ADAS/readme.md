# 高级驾驶辅助系统 Advanced Driving Assistance system

[ADAS芯片解决方案汇总 ](https://www.cnblogs.com/shaobojiao/p/8274481.html)

ADAS（高级辅助驾驶系统），是指利用安装于车上各式各样的传感器，在第一时间收集车内的环境数据，进行静、动态物体的辨识、侦测与追踪等技术上的处理，从而能够让驾驶者在最快的时间察觉可能发生的危险。
 
在过去的两年多时间，笔者拜访了数百家企业，最近一直花时间在做针对性地梳理和总结。在现在的电子信息领域，跨界融合的节奏越来越快，产业链各环节的衔接也是前所未有的紧密，所以现在看一个领域或一个项目，需要从整个产业链条各环节去综合考虑，包括云管端，包括硬件、软件、算法、数据，且各产业链条上各家企业，随时做前向或后向的整合，竞合关系随时转换。随着新硬件时代的来临，对产业的研究提出了更高的要求，思考的纬度需要变得更宽，要理清里面错综复杂的关系以及未来的发展趋势，工作量数倍于从前。
 
而对产业链各个环节标杆企业的研究是必备的功课，只有了解这些大企业的策略和动向，才能发现其中可能存在的创业/投资机会。所以最近有意识的对大企业做一点研究，如之前的音频、视觉、IOT平台等，以及本篇的主要针对ADAS的芯片厂商，理解各家的主要产品线和状态。
 
通常包括导航与实时交通系统TMC，电子警察系统ISA 、自适应巡航ACC 、车道偏移报警系统LDWS、车道保持系统，碰撞避免或预碰撞系统、夜视系统、自适应灯光控制、行人保护系统、自动泊车系统、交通标志识别、盲点探测，驾驶员疲劳探测、下坡控制系统和电动汽车报警系统等。
 
目前来看汽车的创新绝大部分来自于汽车电子的创新，而从汽车电子系统来讲，正在由分散式架构（众多的ECU控制），逐渐向集中式乃至中央控制系统（超级处理器）演进，这一趋势落实到ADAS上也是同样规律。这一趋势的变化，包括减少ECU，降低功耗，提高处理器和内存利用效率，降低软件的开发难度和提高安全，使汽车半导体厂商在整个汽车产业中扮演越来越重要的角色。同时，对ADAS处理器芯片来说，目前呈现出如智能家居类似的产品形态，单品爆款，以及多功能的组合，即类似于Mobileye的视觉处理ADAS芯片单品，以及多传感器的融合，使ADAS处理芯片成为平台的趋势。目前来看这两种形态都有市场，单功能会使ADAS在中低端车甚至后装市场，更大范围的普及，当然性价比是前提。而多传感器的融合会提升自动驾驶的等级向Level4甚至Level5方向走，目前像Google、百度等无人车都在做多传感器的融合，只是目前为止还没有专门的Level4/5ADAS ASIC芯片而已。
 
从芯片设计来说，现在ADAS处理器芯片的主要挑战在如下几个方面：
 
1）车规级的标准，最好过ISO26262，达到ASIL-B甚至ASIL-D级别
 
2）高计算量以及高带宽，特别是多传感器融合的芯片，需要更高的芯片频率，以及异构设计，以达到快速的数据处理速度，同时传输的吞吐率上也有较高要求。
 
3）随着人工智能在ADAS上的应用，针对芯片的设计会考虑增加硬件的深度学习设计，如何在软硬件上做取舍，以及人工智能计算模型与原有软硬件架构以及整个系统设计上做匹配，目前来看还在早期探索阶段。
 
下面主要介绍各家主要ADAS处理器芯片厂商的产品，希望从他们的产品中一窥现在ADAS处理器芯片领域的现状，以及未来的发展趋势。


> **场景:**

高速道路：前视摄像头 检测前方车辆 利用目标检测（车道线、车辆）、目标跟踪（车辆）、目标分割（车道），判断车辆速度、车辆位置，完成车道保持、车道偏离预警、换道、自动刹车等。

城市道路: 激光雷达，摄像头，识别行人、车辆、斑马线、红路灯、障碍物等，完成辅助驾驶员行驶

停车，自动泊车，自动倒车入库、侧方停车等。

传感器: 激光雷达、毫米波雷达、超声测距、摄像头、GPS、IMU等

执行器: 电控执行器，刹车brake、离合gearbox、转向sterring、油门engine、车灯（转向灯、远光灯、近光灯）

车内：  人机交互，控制面板、仪表盘、HUD抬头显示、可震动的方向盘、可收紧的安全带、可声光提醒的仪表符号。

车内面向驾驶员的摄像头: 驾驶员安全行为检测，安全带检测、打电话、玩手机、抽烟、眼睛疲劳、人脸识别（身份验证）等


L0 L1 L2 属于ADAS

L3 L4 L5 自动驾驶 AD  Autonous Drining


L0 :

LDW ： Lane departure warning     车道偏离预警

FCW ： Forward collision warning  前车碰撞预警

TSR :  Traffic sign resognition   交通标志识别  限速识别

AVS ： Aided Video System        辅助视频系统

LCA :  Lane Change Assist        辅助变道

AHBA：  自动远近光灯切换

IHC     智能大灯控制

NV      Night Viision   夜视

BSD    Bind spot detect   盲点检测



L1:

LKA : lane keep assist   车道保持

AEB : aUTO emergency Braking   自动紧急刹车

ACC : Adaptive Cruise Control  自适应巡航

L2:

LKA : lane keep assist   车道保持

APA : Parking            自动泊车辅助





#  ADAS FCW 前车碰撞预警

#  ADAS AEB 自动紧急刹车

# ADAS LDW 车道偏离预警

# 定速巡航控制软件开发 ACC : Adaptive Cruise Control  自适应巡航

# ADAS LCA Lane Change Assist 辅助变道

# 自动驾驶基础--路径搜索算法Dijkstra

# 自动驾驶基础--路径规划算法A*

# 自动驾驶基础--动态路径规划算法

# 自动驾驶路径规划--车辆防碰撞问题

# AD路径跟踪算法

# ADAS功能软件开发_BSD



## 芯片

高通/NXP

由于高通已经收购NXP，所以在这里一起介绍。高通自己主要通过自己的移动处理器芯片（改成车规级），开始逐步切入ADAS，当然刚开始做环视等，最近有和纵目合作，在CES上推出首个基于骁龙820A平台并运用深度学习的最新ADAS产品原型，该产品运行了820A神经网络处理引擎（SNPE），能实现对车辆、行人、自行车等多类物体识别，以及对像素级别可行驶区域的实时语义分割，当然离商用应该还有一定距离。总的来说，高通骁龙产品策略应该还是以车载娱乐信息系统为主，逐步向更专业的ADAS拓展。
 
同时，NXP以及之前NXP收购的飞思卡尔，在汽车电子和ADAS芯片领域都有完整的产品线布局。
 
NXP已经发布Blubox平台，为OEM厂商提供设计、制造、销售Level 4级（SAE）无人驾驶汽车的解决方案计算平台。下图是NXP的ADAS系统框图，该系统对多路视频、77G雷达的数据进行融合处理，然后传送给云端和车身系统。我们看到NXP是能够提供全套Reference方案的公司，在这一块的产品线很全，虽然现在没有做更多的芯片集成，而是提供相对分散的芯片及解决方案。我们这里重点介绍一下中央处理器S32V234和MPC5775K，MPC5775K是对雷达数据进行处理，而S32V234是对多传感器处理过的数据进行融合分析，通过CAN总线，把结果传给车身系统。
 
S32V234是NXP的S32V系列产品中2015年推出的ADAS处理器，支持CPU（4颗ARM V8架构A53和M4）、GPU（GC3000）和图像识别处理（CogniVue APEX2 processors）的异构计算，5W的低功耗设计。通过CogniVue APEX2 processors能同时支持四路汽车摄像头（前、后、左、右），抽取图像并分类，同时GPU能实时3D建模，计算量达到50 GFLOPs。所以按照此硬件架构可完成360度环视，完成自动泊车等功能。同时，该芯片预留了支持毫米波雷达、激光雷达、超声波的接口，便于实现多传感器的融合，该芯片支持ISO 26262 ASIL B标准。
 
Qorivva MPC567xK系列基于Power Architecture 的32位MCU，MPC577XK是专门的雷达信息处理芯片，该系列增加了芯片的存储器，提升了运行速度和性能，能够支持自适应巡航控制、智能大灯控制、车道偏离警告和盲点探测等应用。从整个雷达系统来看，结合77G雷达收发器芯片组、Qorivva MPC567xK MCU、FPGA, ADC, DAC, SRAM, 支持长、中、短距离应用。这里需要重点关注的是信号处理工具集（Signal Processing Toolbox）设计，包括了FFT、DMA、COPY、Scheduler。目前77GHz的FCMW型雷达在数字信号处理中需要使用FFT，即快速傅里叶变换，一般车载雷达的采样点在512-2048左右，从芯片架构图我们看到专门的FFT电路。
 
除了S32V系列，被收购的飞思卡尔有一款著名的i.MX系列芯片也可以作为中央处理器。i.MX特别是i.MX6在汽车上，特别是车载信息系统上有大量的应用。众多的汽车厂商使用i.MX。
 
 
英特尔/Mobileye/Altera

通过一系列的收购，英特尔在ADAS处理器上的布局已经完善，包括Mobileye的ADAS视觉处理，利用Altera的FPGA处理，以及英特尔自身的至强等型号的处理器，可以形成自动驾驶整个硬件超级中央控制的解决方案。
 
其中特别要指出的是Mobileye的EyeQ系列，已经被多家汽车制造商使用，包括奥迪、宝马、菲亚特、福特、通用、本田、日产、标致、雪铁龙、雷诺、沃尔沃和特斯拉等在内。最近的EyeQ4展示的性能已经达到2.5万亿次每秒的性能，其运行功率可低至3W。从硬件架构来看，该芯片包括了一组工作在1 GHZ的工业级四核MIPS处理器，以支持创新性的多线程技术能更好的进行数据的控制和管理。多个专用的向量微码处理器（VMP），用来应对ADAS相关的图像处理任务（如：缩放和预处理、翘曲、跟踪、车道标记检测、道路几何检测、滤波和直方图等）。一颗军工级MIPS Warrior CPU位于次级传输管理中心，用于处理片内片外的通用数据。
 
由于目前融合多是雷达与摄像头融合，所需要的带宽，一般的ASIC都能够满足。但是要融合激光雷达，则最好用FPGA，FPGA做传感器Hub是最合适不过的。同时传感器融合目前应用较少，合适的ASIC并不好找，FPGA成为主流选择。同时，对一些精度要求较高的雷达，如使用单精度浮点处理实现一个4096点FFT，采样点越多，误差就越小，但运算量会大幅度增加。它在每个时钟周期输入输出四个复数采样。每个FFT内核运行速度超过80 GFLOPs，这一般需要FPGA才能比较好的实现。一般车载雷达的采样点在512-2048左右，但军用的可以达到8192，必须配备FPGA。如下图在AudizFAS的实物中，采用了Altera的CycloneV SoCFPGA，作为sensor fusion，同时负责毫米波雷达与激光雷达数据处理。
 
 
瑞萨（Renesas）

瑞萨针对ADAS处理器这一块业务，提供了较完整的产品线系列，也提供ADAS Kit开发系统。就芯片系列来说，最出名的莫过于其R-Car产品线，该系列高配产品的硬件架构包括了ARM Cortex A57/53、ARM Cortex R系列、Video Codec，2D/3DGPU、ISP等，能同时支持多路的视觉传感器输入，支持OPENGL、OpenCV等软件，符合ASILB车规级别。其实该产品最早是用于车载信息娱乐系统，而后该系统产品逐步适配汽车环视视觉系统、仪表板及ADAS系统等，该发展路径值得国内想进去汽车领域的半导体厂商借鉴。
 
除了R-Car系列产品外，就像NXP一样，瑞萨也有针对雷达传感器的专业处理器芯片如RH850/V1R-M系列，该产品采用40nm内嵌eFlash技术，优化的DSP能快速的进行FFT的处理。
 
最近有报道说瑞萨发布了Renesas Autonomy，一个全新设计的ADAS和自动驾驶平台。具体细节还不清楚，但是据瑞萨电子美国区汽车业务副总裁Amrit Vivekanand指出，瑞萨此次推出的自动驾驶平台与竞争对手不同，“这是一个开放的平台，希望用户更方便地将他们的算法、函数库和实时操作系统（RTOS）移植到平台中来。” Renesas Autonomy平台发布的第一个产品，是一块图像识别片上系统（SoC），叫作R-Car V3M。瑞萨将该高性能视觉处理芯片描述为“优化处理单元，首选应用于智能相机传感器，也可以用于环绕视觉系统甚至激光雷达的数据处理。”来自半导体行业分析公司Linley Group的高级分析师Mike Demler认为，此次发布的开放平台和产品，可以看作一种瑞萨电子对标Mobileye的布局，“他们希望吸引到没有与Mobileye合作的汽车制造商，尤其是日本厂商，也希望吸引到一些制造ADAS产品的Tier 1厂商。 ”相比于Mobileye处理平台的“黑箱”系统，瑞萨在不断强调解决方案的“开放”二字，这也是每个誓要抗衡Mobileye的处理器厂商都倾向于谈论的问题。瑞萨方面表示，其最新发布的R-Car V3M处理模块的全部算法将对其用户开放。
 
 
英飞凌（Infineon）

作为汽车电子、功率半导体以及智能卡芯片的全球市场领袖，英飞凌一直以来为汽车等工业应用提供半导体和系统解决方案。英飞凌在24/77/79G雷达、激光雷达等传感器器件及处理芯片方面都具有领先的技术。除此之外，在车身控制、安全气囊、EPS、TPMS等等各方面都有自己的解决方案。
 
 
德州仪器（TI）

TI在ADAS处理器上实际上是走得两条产品线，Jacinto和TDA系列。Jacinto系列主要是基于之前的OMAP处理器开发而来，TI在放弃移动处理器平台后，将数字处理器的重点放在了汽车等应用上，主要是车载信息娱乐系统。但是从Jacinto6中，我们看到车载信息娱乐与ADAS功能的结合，这款芯片包括了双ARM Cortex-A15内核、两个ARM M4内核、两个C66x浮点DSP、多个3D/2D图形处理器GPU（Imagination），并且还内置了两个EVE加速器。这款Jacintinto6 SoC处理器的功能异常强大，无论是在处理娱乐影音方面，还是车载摄像头的辅助驾驶，可利用汽车内部和外部的摄像头来呈现如物体和行人检测、增强的现实导航和驾驶员身份识别等多种功能。
 
TDA系列一直是侧重于ADAS功能，TDA3x系列可支持车道线辅助、自适应巡航控制、交通标志识别、行人与物体检测、前方防碰撞预警和倒车防碰撞预警等多种ADAS算法。这些算法对于前置摄像头、全车环视、融合、雷达与智能后置摄像头等众多ADAS应用的有效使用至关重要。
 
 
英伟达（NVIDIA）

随着人工智能和无人驾驶技术的兴起，由于NVIDIA的GPU极强的并行计算能力，特别适合做深度学习。一般认为相对于Mobileye只专注于视觉处理，NVIDIA的方案重点在于融合不同传感器，据传特斯拉已经放弃Mobileye，而采用NVIDIA。
 
NVIDIA推出的Drive PX2被黄仁勋称为“为汽车设计的超级电脑”，它将成为汽车的标准配备，可以用来感知汽车所处位置、辨识汽车周遭的物体，并且即时计算最安全的路径。“Tegra X1处理器和10GB内存，能够同时处理12个200万像素摄像头每秒60帧的拍摄图像，并通过环境视觉计算技术和强大的深层神经网络，主动识别道路上的各种车辆，甚至还能检测前方车辆是否在开门。Driver PX2还搭载了其他合作伙伴的芯片，包括Avago的PEX8724(24-lane，6-port，第三代 PCIe Gen交换机）用于两块Parker之间的互联。还有一片英特尔收购的Altera提供的FPGA，用于执行实时操作系统。FPGA的型号为Cyclone V 5SCXC6，是Altera的顶级产品，逻辑运算为110K，注册器达166036。最后还有一款英飞凌的AURIX TC 297 MCU做安全控制，据说可以让PX2达到ASIL C级水平。 还有博通的BCM89811低功耗物理层收发器（PHY），使用BroadR-Reach车载以太网技术，在单对非屏蔽双绞线上的传输速率可达100Mbps。所以NVidia实际上推出了板级的ADAS系统。
 
ADI

相对于以上介绍的几家芯片公司，ADI在ADAS芯片上的策略主打性价比。ADAS技术目前基本应用在高端车型中，主要是因为总体成本高，ADI针对高、中、低档汽车，ADI针对性的推出某一项或几项ADAS技术进行实现，并把成本降到2美元、十几美元，对整车厂商及消费者无疑是一大好消息。
 
在视觉ADAS上ADI的Blackfin系列处理器被广泛的采用，其中低端系统基于BF592，实现LDW功能；中端系统基于BF53x/BF54x/BF561，实现LDW/HBLB/TSR等功能；高端系统基于BF60x，采用了“流水线视觉处理器（PVP）“，实现了LDW/HBLB/TSR/FCW/PD等功能。集成的视觉预处理器能够显著减轻处理器的负担，从而降低对处理器的性能要求。
 
值得一提的是，ADI最近推出Drive360TM 28nm CMOS RADAR技术（77/79GHz），将绝佳的RF性能运用于目标识别和分类，革新了ADAS应用的传感器性能。ADI的高性能RADAR解决方案能够提前探测快速移动的小型物体，而极低相位噪声能够在存在大物体的情况下对小物体进行最清楚的检测。ADI与瑞萨合作，共同针对该芯片推出系统性方案，结合ADI的RADAR，以及瑞萨Autonomy平台的RH850/V1R-M微控制器(MCU)。
 
 
富士通（Fujitsu）

富士通的ADAS技术主要涉及透过摄像头和传感器的结合，实现图像识别辅助和接近目标检测，应用的领域主要有360度3D立体全景辅助、可视停车辅助、驾驶盲区监控、安全开车门以及车行驶方向周围的障碍物和行人的识别。包括基于MB86R11“Emerald-L”2D/3D图像SoC的全景视频系统支持前后左右四个摄像头进行汽车周边环境的实时全景视频监测。从公开资料显示，富士通似乎更热衷于虚拟仪表盘及车载信息娱乐系统的构建，但这一块是最容易被国内芯片公司模仿并超越的。


